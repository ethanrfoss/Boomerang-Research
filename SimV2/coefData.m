% alpha = [0:1:20,46,47,49,50,52,53,55,56,58,59,61,62,64,65,66,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90] ;
% %CL = [.5936,.7871,.975,1.1466,1.2991,1.4221,1.3123,1.3084,1.3264,.9911,1.0131,1.072,1.112,1.1621,1.2085,1.2511];
% CL = [.6170 .7135 .8149 .9144 1.0111, 1.1037, 1.1931,1.2759,1.3570,1.4172,1.3457,1.3701,1.3123,1.3082,1.3084,1.3243,1.3097,.9709,.7719,.7558,.7629,.8251,.8130,.7866,.7720,.7407,.7239,.6886,.67,.6314,.6114,.5704,.5491,.5062,.4845,.4625,.4188,.3969,.3748,.3532,.3316,.3102,.2889,.2474,.2272,.2073,.1879,.1688,.1504,.1324,.1149,.0978,.0802,.0687,.065,.0584,.0518,.0451];
% CM = [-.081,-.078,-.077,-.075,-.074,-.072,-.069,-.065,-.061,-.054,-.031,-.022,-.015,-.013,-.014,-.014,-.018,-.069,-.084,-.095,-.104];
% CD = [.01526,.01672,.01841,.02029,.02234,.02491,.02737,.02943,.03132,.03217,.03257,.03821,.05211,.06335,.07521,.08624,.10261,.19773,.23868,.24902,.26179];
% plot(alpha,CL)


a = -20:.25:20;
CL = [-[.4965,.4832,.4690,.4595,.4511,.4433,.4362,.4324,.4389,.4477,.4125,.4027,.3949,.3883,.3840,.3921,.4057,.3707,.3603,.3537],...
    -[.3502,.3542,.3598,.3382,.3308,.3281,.3437,.3362,.3177,.3137,.3328,.3331,.3105,.3054,.3248,.3614,.3089,.3084,.3258,.3704],...
    -[.4094,.3558,.3606,.3797,.4089,.4448,.4802,.4617,.4448,.4187,.3888,.3628,.3383,.3118,.2804,.2582,.2215,.1851,.1429,.1148],...
    [-.0664,-.0347,.016,.046,.0914,.1232,.166,.1951,.2387,.2648,.2918,.3191,.4390,.4634,.4857,.5086,.5309,.5515,.5724,.5944],...
    [.6169,.6404,.6641,.6893,.7135,.7390,.7646,.7893,.8149,.8414,.8667,.8898,.9144,.9411,.9625,.9861,1.0112,1.0384,1.0598,1.0814,1.1038,...
    1.1273,1.1548,1.1714,1.1932,1.2195,1.2346,1.2643,1.2760,1.3025,1.3175,1.3385,1.3573,1.376,1.3896,1.4148,1.4174,1.4273,1.4374,1.4324,1.4223,...
    1.4136,1.4031,1.3892,1.3703,1.3495,1.3322,1.3195,1.3123,1.3101,1.3065,1.3067,1.3080,1.3067,1.3129,1.3077,1.3087,1.3145,1.3099,1.3117,1.3235,...
    1.3148,1.3057,1.2993,1.3257,1.3064,1.2833,1.2585,1.2312,1.1983,1.1516,.9864,.9920,.9732,.9701,.9794,.9955,1.025,1.0013,1.0018,1.0127]];
CM = -[[.005,.006,.006,.007,.008,.009,.011,.013,.017,.020,.017,.018,.0187,.020,.022,.025,.029,.026,.026,.027],...
    [.028,.032,.033,.031,.031,.032,.036,.034,.034,.038,.039,.036,.036,.038,.042,.036,.035,.035,.035,.034],...
    [.031,.029,.026,.023,.020,.020,.025,.017,.029,.030,.032,.040,.047,.047,.052,.055,.058,.066,.069,.070],...
    [.073,.073,.077,.077,.079,.081,.081,.082,.081,.090,.079,.094,.093,.091,.089,.087,.085,.085,.084,.082],...
    [.081,.080,.080,.079,.078,.078,.078,.077,.077,.077,.077,.076,.075,.075,.074,.074,.074,.074,.073,.072,.072,...
    .071,.071,.07,.069,.069,.067,.068,.065,.065,.064,.063,.061,.060,.058,.058,.054,.051,.048,.043,.038,...
    .033,.039,.025,.022,.02,.018,.016,.015,.014,.014,.014,.013,.013,.013,.014,.014,.014,.014,.015,.014,...
    .016,.017,.019,.017,.020,.023,.027,.033,.039,.040,.082,.084,.090,.094,.095,.095,.093,.1,.104,.104]];
CD = [[.21555,.20895,.20342,.2008,.19703,.19409,.19125,.18931,.19039,.19141,.17919,.17577,.17270,.16975,.16717,.16720,.16766,.15778,.15432,.15136],...
    [.14863,.14849,.14423,.13922,.13624,.13356,.13283,.12829,.12449,.12187,.12104,.11735,.11326,.11076,.10974,.10958,.10297,.10080,.09958,.10015],...
    [.10020,.09370,.09220,.09118,.08051,.08934,.08642,.08385,.07992,.07489,.0718,.06688,.06306,.06020,.05643,.05377,.05018,.03910,.03548,.03317],...
    [.03063,.02882,.02697,.02606,.02483,.02395,.02262,.02193,.02073,.02002,.01915,.01803,.01470,.01440,.01418,.01402,.01402,.01424,.01456,.01491],...
    [.01526,.01561,.01597,.01635,.01672,.01712,.01755,.01797,.01841,.01888,.01938,.01964,.02028,.02078,.02128,.0218,.02234,.02292,.02356,.02423,.02492,...
    .02559,.02616,.02686,.02737,.02789,.02943,.02975,.03044,.0308,.03133,.03157,.03194,.03184,.03217,.03225,.03217,.03224,.03203,.0322,.03257,...
    .03304,.03402,.03554,.03822,.04170,.04536,.04893,.05214,.05490,.05801,.06067,.06342,.06645,.06861,.07235,.07525,.07765,.08159,.08459,.08636,...
    .09115,.09603,.10058,.10074,.10722,.11459,.12269,.13169,.14235,.16498,.23278,.23877,.23975,.24233,.24533,.24910,.25910,.25670,.25897,.26181]];

aspos = 16.25*pi/180;
asneg = -12*pi/180;
alphaneg = [-180+aspos*180/pi:.25:asneg*180/pi]*pi/180;
alphapos = [180/pi*aspos:.25:180+asneg*180/pi]*pi/180;
AR = 2.2411;
CDspos = CD(find(a == aspos*180/pi));
CLspos = CL(find(a == aspos*180/pi));
CDsneg = CD(find(a == asneg*180/pi));
CLsneg = CL(find(a == asneg*180/pi));

CDmax = 1.11+.018*AR;
B2 = (CDspos-CDmax*sin(aspos)^2)/cos(aspos);
Cdpos = CDmax.*sin(alphapos).^2+B2.*cos(alphapos);

A2 = (CLspos-CDmax*sin(aspos)*cos(aspos))*sin(aspos)/cos(aspos)^2;
Clpos = CDmax/2*sin(2*alphapos)+A2*cos(alphapos).^2./sin(alphapos);

CDmax = 1.11+.018*AR;
B2 = (CDsneg-CDmax*sin(asneg)^2)/cos(asneg);
Cdneg = CDmax.*sin(alphaneg).^2+B2.*cos(alphaneg);

A2 = (CLsneg-CDmax*sin(asneg)*cos(asneg))*sin(asneg)/cos(asneg)^2;
Clneg = CDmax/2*sin(2*alphaneg)+A2*cos(alphaneg).^2./sin(alphaneg);

alphaneg = [alphapos(end)-2*pi, alphaneg];
alphapos = [alphapos, 2*pi+alphaneg(2)];
Cdneg = [Cdpos(end), Cdneg];
Cdpos = [Cdpos, Cdneg(2)];
Clneg = [Clpos(end), Clneg];
Clpos = [Clpos, Clneg(2)];

figure(1); 
subplot(2,1,1); hold on
plot(a,CL); plot(alphapos*180/pi,Clpos); plot(alphaneg*180/pi,Clneg);
subplot(2,1,2); hold on
plot(a,CD); plot(alphapos*180/pi,Cdpos); plot(alphaneg*180/pi,Cdneg);

alpha = [alphaneg(1),alphaneg(2):.25*pi/180:alphapos(end-1),alphapos(end)];
CL = [Clneg(1:end-1) CL([find(a == asneg*180/pi):find(a == aspos*180/pi)]) Clpos(2:end)];
CD = [Cdneg(1:end-1) CD([find(a == asneg*180/pi):find(a == aspos*180/pi)]) Cdpos(2:end)];

figure(2);
subplot(2,1,1); hold on; title('C_L vs. \alpha');
plot(alpha*180/pi,CL);
xlabel('\alpha[deg]'); ylabel('C_L');
subplot(2,1,2); hold on; title('C_D vs. \alpha');
plot(alpha*180/pi,CD);
xlabel('\alpha[deg]'); ylabel('C_D');